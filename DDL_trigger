use AdventureWorksDW2019

create trigger trmyfirsttrigger
on database
for create_table
as
begin 
    print 'loodi uus tabel'
end	

-- ei luba tabeleid teha ega muuta
alter trigger trmyfirsttrigger
on database 
for create_table, alter_table, drop_table
as
begin
    rollback
    print 'sa ei tohi tabeleid teha ega muuta'
end

disable trigger trmyfirsttrigger on database
drop trigger trmyfirsttrigger on database

-- kui midagi nimetatakse Ã¼mber, nÃ¤ita teadet
create trigger trrenametable
on database
for rename
as
begin
    print 'sa muutsid midagi nimega'
end

exec sp_rename 'testtable', 'newtesttable'
exec sp_rename 'newtesttable.id', 'newid', 'column'

-- keelab tabelite loomise ja muutmise selles andmebaasis
create trigger tr_databasescopetrigger 
on database
for create_table, alter_table, drop_table
as
begin
    rollback
    print 'ei saa siia tabeleid teha ega muuta'
end

-- keelab tabelite loomise ja muutmise kogu serveris
create trigger tr_serverscopetrigger
on all server
for create_table, alter_table, drop_table
as
begin
    rollback
    print 'ei saa tabeleid teha ega muuta serveris'
end

disable trigger tr_serverscopetrigger on all server
enable trigger tr_serverscopetrigger on all server
drop trigger tr_serverscopetrigger on all server
